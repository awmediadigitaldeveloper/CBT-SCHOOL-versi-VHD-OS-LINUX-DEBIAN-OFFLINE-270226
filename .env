# ==============================================================================
#  CBT SCHOOL ENTERPRISE VHD - ENVIRONMENT CONFIGURATION (2026.2.FIXED)
#  Architecture: Dockerized Supabase (Offline Mode - AUTO-IP / ZERO CONFIG)
#  Network     : Dynamic / Any IP (Plug & Play)
#  Maintainer  : Ari Wijaya (System Architect)
# ==============================================================================

# ------------------------------------------------------------------------------
# 1. DATABASE CORE CREDENTIALS (DO NOT CHANGE)
#    Konfigurasi akses langsung ke PostgreSQL (Port 5432)
# ------------------------------------------------------------------------------
POSTGRES_DB=postgres
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_PASSWORD=root_cbt_vhd_secure_2026

# [NEW] CONNECTION POOLING (Enterprise Tuning)
# Mencegah error "Too many connections" saat ribuan siswa mulai ujian
POSTGRES_MAX_CONNECTIONS=200
# Jumlah koneksi standby untuk API
PGRST_DB_POOL=50

# ------------------------------------------------------------------------------
# 2. AUTHENTICATION & SECURITY (JWT)
#    Token rahasia untuk validasi sesi user.
# ------------------------------------------------------------------------------
# PENTING: JWT_SECRET harus sinkron dengan VITE_SUPABASE_ANON_KEY
# Menggunakan default key agar cocok dengan Anon Key yang sudah ada di frontend
JWT_SECRET=super-secret-jwt-token-with-at-least-32-characters-long
JWT_EXPIRY=3600

# [UPDATE] AUTH REDIRECT HANDLING (ZERO CONFIG MODE)
# Menggunakan localhost sebagai base, namun membebaskan jalur masuk via Wildcard (*)
GOTRUE_SITE_URL=http://localhost:8000
GOTRUE_URI_ALLOW_LIST=*
GOTRUE_DISABLE_SIGNUP=true
# (Opsional: Set true agar siswa tidak bisa daftar akun sendiri, harus dari admin)

# ------------------------------------------------------------------------------
# 3. API GATEWAY & NETWORK (KONG) - ZERO CONFIG MODE
# ------------------------------------------------------------------------------
PORT=8000
API_EXTERNAL_URL=http://localhost:8000
SUPABASE_PUBLIC_URL=http://localhost:8000

# ------------------------------------------------------------------------------
# 4. API KEYS (SERVICE DEFINITION) - STRICTLY PRESERVED
# ------------------------------------------------------------------------------
# ANON_KEY (Kunci Publik - Frontend/Siswa)
ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNnaXFteWNhb2tpcnZjaGNxaHpwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwNzg1NDksImV4cCI6MjA4NzY1NDU0OX0.38b8jbVx5IQryR6iy5rt08OKi7nvzwlD0wpeBiwwtGQ

# SERVICE_ROLE_KEY (Kunci Admin - Backend)
SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1cGFiYXNlLXByb2plY3QiLCJyb2xlIjoic2VydmljZV9yb2xlIiwiaWF0IjoxNjYyMjQ2MTI5LCJleHAiOjIwOTc4MjIxMjl9.DaYlNEoUrrEn2Ig7tqibS-PHK5vgusbcbo7X36XVt4Q

# ------------------------------------------------------------------------------
# 5. FRONTEND INTEGRATION (REACT / VITE / NEXT.JS)
# ------------------------------------------------------------------------------
# Catatan: Nilai ini sekarang hanya bertindak sebagai fallback. 
# Logika utama sudah diambil alih oleh script supabaseClient.ts (window.location.hostname)
VITE_SUPABASE_URL=https://sgiqmycaokirvchcqhzp.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNnaXFteWNhb2tpcnZjaGNxaHpwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwNzg1NDksImV4cCI6MjA4NzY1NDU0OX0.38b8jbVx5IQryR6iy5rt08OKi7nvzwlD0wpeBiwwtGQ

NEXT_PUBLIC_SUPABASE_URL=https://sgiqmycaokirvchcqhzp.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNnaXFteWNhb2tpcnZjaGNxaHpwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwNzg1NDksImV4cCI6MjA4NzY1NDU0OX0.38b8jbVx5IQryR6iy5rt08OKi7nvzwlD0wpeBiwwtGQ

# ------------------------------------------------------------------------------
# 6. DASHBOARD CONFIGURATION (STUDIO)
#    Akses visual admin panel via http://[IP-Sekolah]:3000
# ------------------------------------------------------------------------------
STUDIO_DEFAULT_ORGANIZATION=CBT School
STUDIO_DEFAULT_PROJECT=CBT Enterprise
STUDIO_PORT=3000

# [SECURED] KREDENSIAL KEAMANAN REVERSE PROXY NGINX (Zero-Trust)
DASHBOARD_USERNAME=admin@cbtschool.com
DASHBOARD_PASSWORD='4121Wijaya*@?'

# ------------------------------------------------------------------------------
# 7. PERFORMANCE & STORAGE TUNING (HIGH LOAD OPTIMIZATION)
# ------------------------------------------------------------------------------
# Limit Baris Data (Sangat penting untuk export nilai)
PGRST_DB_MAX_ROWS=999999

# Timeout setting (10 detik)
STATEMENT_TIMEOUT=10000s

# [NEW] STORAGE LIMITS
# Membatasi ukuran upload gambar soal/jawaban max 5MB agar disk server aman
FILE_SIZE_LIMIT=5242880